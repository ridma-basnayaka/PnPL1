function [solution_r] = case_4_new(v1,v2,v3,v4)

v = [v1 v2 v3 v4];
%分解奇异向量
v1_3 = v1(1:3,:);    
v1_6 = v1(4:6,:);
v1_9 = v1(7:9,:);    %将奇异向量每三行分开，每个部分分别对应r1,r2,r3

v2_3 = v2(1:3,:);
v2_6 = v2(4:6,:);
v2_9 = v2(7:9,:);

v3_3 = v3(1:3,:);
v3_6 = v3(4:6,:);
v3_9 = v3(7:9,:);

v4_3 = v4(1:3,:);
v4_6 = v4(4:6,:);
v4_9 = v4(7:9,:);

C = [   dot(v2_3,v2_6)  dot(v3_3,v3_6)  dot(v4_3,v4_6)  dot(v2_3,v3_6)+dot(v2_6,v3_3)   dot(v2_3,v4_6)+dot(v2_6,v4_3)   dot(v3_3,v4_6)+dot(v3_6,v4_3)   dot(v1_3,v2_6)+dot(v1_6,v2_3)   dot(v1_3,v3_6)+dot(v1_6,v3_3)   dot(v1_3,v4_6)+dot(v1_6,v4_3)   dot(v1_3,v1_6);
        dot(v2_3,v2_9)  dot(v3_3,v3_9)  dot(v4_3,v4_9)  dot(v2_3,v3_9)+dot(v2_9,v3_3)   dot(v2_3,v4_9)+dot(v2_9,v4_3)   dot(v3_3,v4_9)+dot(v3_9,v4_3)   dot(v1_3,v2_9)+dot(v1_9,v2_3)   dot(v1_3,v3_9)+dot(v1_9,v3_3)   dot(v1_3,v4_9)+dot(v1_9,v4_3)   dot(v1_3,v1_9);
        dot(v2_6,v2_9)  dot(v3_6,v3_9)  dot(v4_6,v4_9)  dot(v2_6,v3_9)+dot(v2_9,v3_6)   dot(v2_6,v4_9)+dot(v2_9,v4_6)   dot(v3_6,v4_9)+dot(v3_9,v4_6)   dot(v1_6,v2_9)+dot(v1_9,v2_6)   dot(v1_6,v3_9)+dot(v1_9,v3_6)   dot(v1_6,v4_9)+dot(v1_9,v4_6)   dot(v1_6,v1_9)];

M =[ C(:,2) C(:,3) C(:,6) ];
Mp = pinv(M);
          
Nk1 = (-1)*[ C(:,8) C(:,9) C(:,10) ];
Nk2 = (-1)*[ C(:,4) C(:,5) C(:,7) ];
Nk3 = (-1)*C(:,1);

X = Mp*Nk1;
Y = Mp*Nk2;
Z = Mp*Nk3;

X11 = X(1,1);   X12 = X(1,2);   X13 = X(1,3);   
X21 = X(2,1);   X22 = X(2,2);   X23 = X(2,3);
X31 = X(3,1);   X32 = X(3,2);   X33 = X(3,3);

Y11 = Y(1,1);   Y12 = Y(1,2);   Y13 = Y(1,3);   
Y21 = Y(2,1);   Y22 = Y(2,2);   Y23 = Y(2,3);
Y31 = Y(3,1);   Y32 = Y(3,2);   Y33 = Y(3,3);

Z1 = Z(1);  Z2 = Z(2);  Z3 = Z(3);
% Xc = num2cell(X');
% [X11,X12,X13,X21,X22,X23,X31,X32,X33] = deal(Xc{:});
% Yc = num2cell(Y');
% [Y11,Y12,Y13,Y21,Y22,Y23,Y31,Y32,Y33] = deal(Yc{:});
% Zc = num2cell(Z');
% [Z1,Z2,Z3] = deal(Zc{:});

k8 = (Z3 - Y12*Y21 + Y31*Y32)^2*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + (Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + (Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) - (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + (Z3 - Y12*Y21 + Y31*Y32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + (Z3 - Y12*Y21 + Y31*Y32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21);
k7 = ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + (Z3 - Y12*Y21 + Y31*Y32)^2*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + 2*(Z3 - Y12*Y21 + Y31*Y32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) - (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + (Z3 - Y12*Y21 + Y31*Y32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + (Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + (Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32);
k6 = ((Z3 - Y12*Y21 + Y31*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (X33 - X12*X21 + X31*X32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((Z3 - Y12*Y21 + Y31*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (X33 - X12*X21 + X31*X32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + (2*(X33 - X12*X21 + X31*X32)*(Z3 - Y12*Y21 + Y31*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)^2)*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + (Z3 - Y12*Y21 + Y31*Y32)^2*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + 2*(Z3 - Y12*Y21 + Y31*Y32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + (Z3 - Y12*Y21 + Y31*Y32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + (Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) - (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32);
k5 = ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (Z3 - Y12*Y21 + Y31*Y32)^2*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + ((Z3 - Y12*Y21 + Y31*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (X33 - X12*X21 + X31*X32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + ((Z3 - Y12*Y21 + Y31*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (X33 - X12*X21 + X31*X32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) - ((- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + ((X33 - X12*X21 + X31*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((X33 - X12*X21 + X31*X32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + (2*(X33 - X12*X21 + X31*X32)*(Z3 - Y12*Y21 + Y31*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)^2)*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) - (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + 2*(X33 - X12*X21 + X31*X32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + 2*(Z3 - Y12*Y21 + Y31*Y32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + (Z3 - Y12*Y21 + Y31*Y32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + (Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + (Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22);
k4 = ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((Z3 - Y12*Y21 + Y31*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (X33 - X12*X21 + X31*X32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + ((Z3 - Y12*Y21 + Y31*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (X33 - X12*X21 + X31*X32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((X33 - X12*X21 + X31*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + ((X33 - X12*X21 + X31*X32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + (2*(X33 - X12*X21 + X31*X32)*(Z3 - Y12*Y21 + Y31*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)^2)*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + (Z3 - Y12*Y21 + Y31*Y32)^2*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + (X33 - X12*X21 + X31*X32)^2*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) - ((- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + ((X33 - X12*X21 + X31*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + ((X33 - X12*X21 + X31*X32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) - (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) - (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(- Z1*Y31^2 - 2*Y31*Y32*Z3 - Z2*Y32^2 - Z3^2 + (Y11*Y12 + Y12*Y21)*Z3 + Z1*Z2 + Y11*Y21*Z1 + Y12*Y22*Z2) + 2*(Z3 - Y12*Y21 + Y31*Y32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + 2*(X33 - X12*X21 + X31*X32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33);
kk3 = ((X33 - X12*X21 + X31*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) - ((- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + ((X33 - X12*X21 + X31*X32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((X33 - X12*X21 + X31*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + ((X33 - X12*X21 + X31*X32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (X33 - X12*X21 + X31*X32)^2*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + ((Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + ((Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + (2*(X33 - X12*X21 + X31*X32)*(Z3 - Y12*Y21 + Y31*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)^2)*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + ((Z3 - Y12*Y21 + Y31*Y32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (X33 - X12*X21 + X31*X32)*(Y11*Z3 + Y12*Z2 - Y31*Z1 - Y32*Z3))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((Z3 - Y12*Y21 + Y31*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (X33 - X12*X21 + X31*X32)*(Y21*Z1 + Y22*Z3 - Y31*Z3 - Y32*Z2))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + 2*(Z3 - Y12*Y21 + Y31*Y32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) - (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13*Z2 + Y23*Z1 - 2*Y33*Z3 + Z1*(X11*Y21 + X21*Y11) + Z2*(X12*Y22 + X22*Y12) - Z3*(2*X31*Y32 + 2*X32*Y31) + Y33*(Y11*Y12 + Y12*Y21) + Z3*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - Y13*Y31^2 - Y23*Y32^2 + Y11*Y13*Y21 + Y12*Y22*Y23 - 2*X31*Y31*Z1 - 2*X32*Y32*Z2 - 2*Y31*Y32*Y33) + 2*(X33 - X12*X21 + X31*X32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + (X33 - X12*X21 + X31*X32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + (X33 - X12*X21 + X31*X32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y11*Z2 + Y21*Z2 - 2*Y31*Z3 + Y31*(Y11*Y12 + Y12*Y21) + Y11^2*Y21 - Y11*Y31^2 - Y21*Y32^2 - 2*Y31^2*Y32 + Y12*Y21*Y22) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y12*Z2 + Y22*Z1 - 2*Y32*Z3 + Y32*(Y11*Y12 + Y12*Y21) + Y12*Y22^2 - Y12*Y31^2 - Y22*Y32^2 - 2*Y31*Y32^2 + Y11*Y12*Y21);
kk2 = ((X33 - X12*X21 + X31*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) - ((- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31) + (- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) + ((X33 - X12*X21 + X31*X32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- Y31^2 + Y22*Y31 + Z2 + Y11*Y21 - Y21*Y32) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- Y32^2 + Y11*Y32 + Z1 + Y12*Y22 - Y12*Y31) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) - ((- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + (X33 - X12*X21 + X31*X32)^2*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + ((X33 - X12*X21 + X31*X32)*(X11*Z3 + X12*Z2 - X31*Z1 - X32*Z3 + Y12*Y23 + Y11*Y33 - Y13*Y31 - Y32*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (Z3 - Y12*Y21 + Y31*Y32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((X33 - X12*X21 + X31*X32)*(X21*Z1 + X22*Z3 - X31*Z3 - X32*Z2 + Y13*Y21 + Y22*Y33 - Y23*Y32 - Y31*Y33) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (Z3 - Y12*Y21 + Y31*Y32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + (2*(X33 - X12*X21 + X31*X32)*(Z3 - Y12*Y21 + Y31*Y32) + (Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)^2)*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) + (X33 - X12*X21 + X31*X32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33)*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) + (X33 - X12*X21 + X31*X32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33)*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Z2 + X22*Z1 - 2*X32*Z3 + Y12*Y23 + Y13*Y22 - 2*Y32*Y33 + Y21*(X11*Y12 + X12*Y11) + X32*(Y11*Y12 + Y12*Y21) + Y32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X12*Y22^2 - X12*Y31^2 - X22*Y32^2 - 2*X31*Y32^2 + X21*Y11*Y12 + 2*X22*Y12*Y22 - 2*X31*Y12*Y31 - 2*X32*Y22*Y32 - 4*X32*Y31*Y32) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X11*Z2 + X21*Z2 - 2*X31*Z3 + Y11*Y23 + Y21*Y23 - 2*Y31*Y33 + Y22*(X12*Y21 + X21*Y12) + X31*(Y11*Y12 + Y12*Y21) + Y31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X21*Y11^2 - X11*Y31^2 - X21*Y32^2 - 2*X32*Y31^2 + 2*X11*Y11*Y21 + X22*Y12*Y21 - 2*X31*Y11*Y31 - 2*X32*Y21*Y32 - 4*X31*Y31*Y32) - (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X13*Z2 + X23*Z1 - 2*X33*Z3 + Y13*Y23 + Z3*(X11*X12 + X12*X21) + Y13*(X11*Y21 + X21*Y11) + Y23*(X12*Y22 + X22*Y12) - Y33*(2*X31*Y32 + 2*X32*Y31) + X33*(Y11*Y12 + Y12*Y21) + Y33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X13*Y31^2 - X23*Y32^2 - X31^2*Z1 - X32^2*Z2 - Y33^2 + X11*X21*Z1 + X12*X22*Z2 + X13*Y11*Y21 + X23*Y12*Y22 - 2*X31*X32*Z3 - 2*X31*Y13*Y31 - 2*X32*Y23*Y32 - 2*X33*Y31*Y32) + 2*(X33 - X12*X21 + X31*X32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33);
kk1 = ((X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31) + (- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + ((X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + (X33 - X12*X21 + X31*X32)^2*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) - ((- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(Y13 + X12*Y22 + X22*Y12 + X11*Y32 - X12*Y31 - X31*Y12 + X32*Y11 - 2*X32*Y32) + (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(Y23 + X11*Y21 + X21*Y11 - X21*Y32 + X22*Y31 + X31*Y22 - X32*Y21 - 2*X31*Y31))*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) + ((X33 - X12*X21 + X31*X32)*(X12*Y23 + X23*Y12 + X11*Y33 - X13*Y31 - X31*Y13 + X33*Y11 - X32*Y33 - X33*Y32) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + ((X33 - X12*X21 + X31*X32)*(X13*Y21 + X21*Y13 + X22*Y33 - X23*Y32 - X32*Y23 + X33*Y22 - X31*Y33 - X33*Y31) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31))*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) - (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X13*Y23 + X23*Y13 - 2*X33*Y33 + Y33*(X11*X12 + X12*X21) + X13*(X11*Y21 + X21*Y11) + X23*(X12*Y22 + X22*Y12) - X33*(2*X31*Y32 + 2*X32*Y31) + X33*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) - X31^2*Y13 - X32^2*Y23 + X11*X21*Y13 + X12*X22*Y23 - 2*X13*X31*Y31 - 2*X23*X32*Y32 - 2*X31*X32*Y33) + (X33 - X12*X21 + X31*X32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33)*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (X33 - X12*X21 + X31*X32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33)*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*Y23 + X13*Y22 + X22*Y13 + X23*Y12 - 2*X32*Y33 - 2*X33*Y32 + Y32*(X11*X12 + X12*X21) + X21*(X11*Y12 + X12*Y11) + X32*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X22^2*Y12 - X31^2*Y12 - X32^2*Y22 - 2*X32^2*Y31 + X11*X12*Y21 + 2*X12*X22*Y22 - 2*X12*X31*Y31 - 2*X22*X32*Y32 - 4*X31*X32*Y32) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X11*Y23 + X23*Y11 + X21*Y23 + X23*Y21 - 2*X31*Y33 - 2*X33*Y31 + Y31*(X11*X12 + X12*X21) + X22*(X12*Y21 + X21*Y12) + X31*(X11*Y12 + X12*Y11 + X12*Y21 + X21*Y12) + X11^2*Y21 - X31^2*Y11 - X32^2*Y21 - 2*X31^2*Y32 + 2*X11*X21*Y11 + X12*X21*Y22 - 2*X11*X31*Y31 - 2*X21*X32*Y32 - 4*X31*X32*Y31) + 2*(X33 - X12*X21 + X31*X32)*(Y33 - X12*Y21 - X21*Y12 + X31*Y32 + X32*Y31)*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23);
k0 = (X33 - X12*X21 + X31*X32)^2*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) - (- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(- X13*X31^2 - 2*X31*X32*X33 - X23*X32^2 - X33^2 + (X11*X12 + X12*X21)*X33 + X13*X23 + X11*X13*X21 + X12*X22*X23) + (X33 - X12*X21 + X31*X32)*(X12*X23 + X11*X33 - X13*X31 - X32*X33)*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22) + (X33 - X12*X21 + X31*X32)*(X13*X21 + X22*X33 - X23*X32 - X31*X33)*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + (X12*X23 + X11*X33 - X13*X31 - X32*X33)*(- X31^2 + X22*X31 + X23 + X11*X21 - X21*X32)*(X12*X23 + X13*X22 - 2*X32*X33 + X32*(X11*X12 + X12*X21) + X12*X22^2 - X12*X31^2 - X22*X32^2 - 2*X31*X32^2 + X11*X12*X21) + (X13*X21 + X22*X33 - X23*X32 - X31*X33)*(- X32^2 + X11*X32 + X13 + X12*X22 - X12*X31)*(X11*X23 + X21*X23 - 2*X31*X33 + X31*(X11*X12 + X12*X21) + X11^2*X21 - X11*X31^2 - X21*X32^2 - 2*X31^2*X32 + X12*X21*X22);

coeffs_k1 = [k8 k7 k6 k5 k4 kk3 kk2 kk1 k0];
solution_k1 = roots(coeffs_k1);
sol_k1 = solution_k1( imag(solution_k1) == 0 );%取实根
if isempty(sol_k1)
    solution_r = ones(9,1);
    return;
end

n = size(sol_k1,1);  %k1实数解数目
A = zeros(2,2);
B = zeros(2,1);
C = zeros(2,1);
k = zeros(1,3);
a1a2a3a4 = [];
for i = 1 : n
    k1 = sol_k1(i);
    M_k = [                                                                                                                                                                                                                                                                                                                                 (X12 + Y12*k1)*(X21 + Y21*k1) - X33 - (X31 + Y31*k1)*(X32 + Y32*k1) - Y33*k1 - Z3*k1^2,                                                                                                                                                                                                                                                                 X13 + (X12 + Y12*k1)*(X22 + Y22*k1) + (X11 + Y11*k1)*(X32 + Y32*k1) - (X12 + Y12*k1)*(X31 + Y31*k1) + Y13*k1 - (X32 + Y32*k1)^2 + Z1*k1^2,                                                                                                                                                                                                                                                                            (X12 + Y12*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X31 + Y31*k1)*(Z1*k1^2 + Y13*k1 + X13) + (X11 + Y11*k1)*(Z3*k1^2 + Y33*k1 + X33) - (X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33);
                                                                                                                                                                                                                                                                              (X21 + Y21*k1)*(X32 + Y32*k1) - (X11 + Y11*k1)*(X21 + Y21*k1) - X23 - (X22 + Y22*k1)*(X31 + Y31*k1) - Y23*k1 + (X31 + Y31*k1)^2 - Z2*k1^2,                                                                                                                                                                                                                                                                                                                    X33 - (X12 + Y12*k1)*(X21 + Y21*k1) + (X31 + Y31*k1)*(X32 + Y32*k1) + Y33*k1 + Z3*k1^2,                                                                                                                                                                                                                                                                            (X32 + Y32*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X21 + Y21*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X22 + Y22*k1)*(Z3*k1^2 + Y33*k1 + X33) + (X31 + Y31*k1)*(Z3*k1^2 + Y33*k1 + X33);
            (X11 + Y11*k1)*(X31 + Y31*k1)^2 - (X11 + Y11*k1)^2*(X21 + Y21*k1) + (X21 + Y21*k1)*(X32 + Y32*k1)^2 - (X11 + Y11*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X21 + Y21*k1)*(Z2*k1^2 + Y23*k1 + X23) + 2*(X31 + Y31*k1)*(Z3*k1^2 + Y33*k1 + X33) - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(X31 + Y31*k1) + (2*X31 + 2*Y31*k1)*(X31 + Y31*k1)*(X32 + Y32*k1) - (X12 + Y12*k1)*(X21 + Y21*k1)*(X22 + Y22*k1), (X12 + Y12*k1)*(X31 + Y31*k1)^2 - (X12 + Y12*k1)*(X22 + Y22*k1)^2 + (X22 + Y22*k1)*(X32 + Y32*k1)^2 - (X22 + Y22*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X12 + Y12*k1)*(Z2*k1^2 + Y23*k1 + X23) + 2*(X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33) - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(X32 + Y32*k1) + (2*X31 + 2*Y31*k1)*(X32 + Y32*k1)^2 - (X11 + Y11*k1)*(X12 + Y12*k1)*(X21 + Y21*k1), (Z3*k1^2 + Y33*k1 + X33)^2 - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(Z3*k1^2 + Y33*k1 + X33) - (Z1*k1^2 + Y13*k1 + X13)*(Z2*k1^2 + Y23*k1 + X23) + (X31 + Y31*k1)^2*(Z1*k1^2 + Y13*k1 + X13) + (X32 + Y32*k1)^2*(Z2*k1^2 + Y23*k1 + X23) - (X11 + Y11*k1)*(X21 + Y21*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X12 + Y12*k1)*(X22 + Y22*k1)*(Z2*k1^2 + Y23*k1 + X23) + (2*X31 + 2*Y31*k1)*(X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33)];
    A = [   M_k(1,1) M_k(1,2);
            M_k(2,1) M_k(2,2)];
    B = -[M_k(1,3) ; M_k(2,3)];    
    C = A\B;
    k2 = C(1);
    k3 = C(2);
    %求a1
    km = [1 k1 k2 k3];
    coe3 = 2*(dot(km,v(1,:))^2 + dot(km,v(2,:))^2 + dot(km,v(3,:))^2)*(2*dot(km,v(1,:))^2 + 2*dot(km,v(2,:))^2 + 2*dot(km,v(3,:))^2) + 2*(dot(km,v(4,:))^2 + dot(km,v(5,:))^2 + dot(km,v(6,:))^2)*(2*dot(km,v(4,:))^2 + 2*dot(km,v(5,:))^2 + 2*dot(km,v(6,:))^2) + 2*(dot(km,v(7,:))^2 + dot(km,v(8,:))^2 + dot(km,v(9,:))^2)*(2*dot(km,v(7,:))^2 + 2*dot(km,v(8,:))^2 + 2*dot(km,v(9,:))^2);
    coe1 = - 4*dot(km,v(1,:))^2 - 4*dot(km,v(2,:))^2 - 4*dot(km,v(3,:))^2 - 4*dot(km,v(4,:))^2 - 4*dot(km,v(5,:))^2 - 4*dot(km,v(6,:))^2 - 4*dot(km,v(7,:))^2 - 4*dot(km,v(8,:))^2 - 4*dot(km,v(9,:))^2;
    coeff_a1 = [coe3 0 coe1];
    solution_a1 = roots(coeff_a1);
    a1 = solution_a1( imag(solution_a1) == 0 );%取实根
    m = size(a1,1);
    k = [k1 k2 k3];
    a1a2a3a4 = [a1a2a3a4 ; a1 repmat(k,m,1)];
end
a1a2a3a4 = [a1a2a3a4(:,1) a1a2a3a4(:,1).*a1a2a3a4(:,2) a1a2a3a4(:,1).*a1a2a3a4(:,3) a1a2a3a4(:,1).*a1a2a3a4(:,4)];
solution_r = [v1 v2 v3 v4] * a1a2a3a4';

end


% syms k1 k2 k3 real
% fk1 = k8*k1^8 + k7*k1^7 + k6*k1^6 + k5*k1^5 + k4*k1^4 + kk3*k1^3 + kk2*k1^2 + kk1*k1 + k0; 
% %求解k1
% solution_k1 = vpasolve(fk1,k1,[-inf inf]);

% M_k = [                                                                                                                                                                                                                                                                                                                                 (X12 + Y12*k1)*(X21 + Y21*k1) - X33 - (X31 + Y31*k1)*(X32 + Y32*k1) - Y33*k1 - Z3*k1^2,                                                                                                                                                                                                                                                                 X13 + (X12 + Y12*k1)*(X22 + Y22*k1) + (X11 + Y11*k1)*(X32 + Y32*k1) - (X12 + Y12*k1)*(X31 + Y31*k1) + Y13*k1 - (X32 + Y32*k1)^2 + Z1*k1^2,                                                                                                                                                                                                                                                                            (X12 + Y12*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X31 + Y31*k1)*(Z1*k1^2 + Y13*k1 + X13) + (X11 + Y11*k1)*(Z3*k1^2 + Y33*k1 + X33) - (X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33);
%                                                                                                                                                                                                                                                                               (X21 + Y21*k1)*(X32 + Y32*k1) - (X11 + Y11*k1)*(X21 + Y21*k1) - X23 - (X22 + Y22*k1)*(X31 + Y31*k1) - Y23*k1 + (X31 + Y31*k1)^2 - Z2*k1^2,                                                                                                                                                                                                                                                                                                                    X33 - (X12 + Y12*k1)*(X21 + Y21*k1) + (X31 + Y31*k1)*(X32 + Y32*k1) + Y33*k1 + Z3*k1^2,                                                                                                                                                                                                                                                                            (X32 + Y32*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X21 + Y21*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X22 + Y22*k1)*(Z3*k1^2 + Y33*k1 + X33) + (X31 + Y31*k1)*(Z3*k1^2 + Y33*k1 + X33);
%  (X11 + Y11*k1)*(X31 + Y31*k1)^2 - (X11 + Y11*k1)^2*(X21 + Y21*k1) + (X21 + Y21*k1)*(X32 + Y32*k1)^2 - (X11 + Y11*k1)*(Z2*k1^2 + Y23*k1 + X23) - (X21 + Y21*k1)*(Z2*k1^2 + Y23*k1 + X23) + 2*(X31 + Y31*k1)*(Z3*k1^2 + Y33*k1 + X33) - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(X31 + Y31*k1) + (2*X31 + 2*Y31*k1)*(X31 + Y31*k1)*(X32 + Y32*k1) - (X12 + Y12*k1)*(X21 + Y21*k1)*(X22 + Y22*k1), (X12 + Y12*k1)*(X31 + Y31*k1)^2 - (X12 + Y12*k1)*(X22 + Y22*k1)^2 + (X22 + Y22*k1)*(X32 + Y32*k1)^2 - (X22 + Y22*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X12 + Y12*k1)*(Z2*k1^2 + Y23*k1 + X23) + 2*(X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33) - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(X32 + Y32*k1) + (2*X31 + 2*Y31*k1)*(X32 + Y32*k1)^2 - (X11 + Y11*k1)*(X12 + Y12*k1)*(X21 + Y21*k1), (Z3*k1^2 + Y33*k1 + X33)^2 - ((X11 + Y11*k1)*(X12 + Y12*k1) + (X12 + Y12*k1)*(X21 + Y21*k1))*(Z3*k1^2 + Y33*k1 + X33) - (Z1*k1^2 + Y13*k1 + X13)*(Z2*k1^2 + Y23*k1 + X23) + (X31 + Y31*k1)^2*(Z1*k1^2 + Y13*k1 + X13) + (X32 + Y32*k1)^2*(Z2*k1^2 + Y23*k1 + X23) - (X11 + Y11*k1)*(X21 + Y21*k1)*(Z1*k1^2 + Y13*k1 + X13) - (X12 + Y12*k1)*(X22 + Y22*k1)*(Z2*k1^2 + Y23*k1 + X23) + (2*X31 + 2*Y31*k1)*(X32 + Y32*k1)*(Z3*k1^2 + Y33*k1 + X33)];

% %substitute k1 into M_k to get k2 and k3
% %each column represents a solution(k1 k2 k3)
% n_k1 = size(solution_k1,1);
% for i = 1 : n_k1
%     M_ki = subs( M_k , k1 , solution_k1(i) );%
%     M = M_ki * [k2;k3;1];
%     [solution_k2,solution_k3] = vpasolve( M(1:2) , [k2 k3] , [-inf inf] );
%     solution_k123(:,i) = [solution_k1(i);solution_k2;solution_k3];
% end

% %use the cost function method introduced in the article to calculate a1
% %different solutions of [k1 k2 k3] generate different r , cost and a1
% % r = a1 .* ( [v1 v2 v3 v4] * [1;k2;k3;k4] )
% vc1 = num2cell(v1);
% [v11,v12,v13,v14,v15,v16,v17,v18,v19] = deal(vc1{:});
% vc2 = num2cell(v2);
% [v21,v22,v23,v24,v25,v26,v27,v28,v29] = deal(vc2{:});
% vc3 = num2cell(v3);
% [v31,v32,v33,v34,v35,v36,v37,v38,v39] = deal(vc3{:});
% vc4 = num2cell(v4);
% [v41,v42,v43,v44,v45,v46,v47,v48,v49] = deal(vc4{:});

% coe3 = 2*((v11 + k1*v21 + k2*v31 + k3*v41)^2 + (v12 + k1*v22 + k2*v32 + k3*v42)^2 + (v13 + k1*v23 + k2*v33 + k3*v43)^2)*(2*(v11 + k1*v21 + k2*v31 + k3*v41)^2 + 2*(v12 + k1*v22 + k2*v32 + k3*v42)^2 + 2*(v13 + k1*v23 + k2*v33 + k3*v43)^2) + 2*((v14 + k1*v24 + k2*v34 + k3*v44)^2 + (v15 + k1*v25 + k2*v35 + k3*v45)^2 + (v16 + k1*v26 + k2*v36 + k3*v46)^2)*(2*(v14 + k1*v24 + k2*v34 + k3*v44)^2 + 2*(v15 + k1*v25 + k2*v35 + k3*v45)^2 + 2*(v16 + k1*v26 + k2*v36 + k3*v46)^2) + 2*((v17 + k1*v27 + k2*v37 + k3*v47)^2 + (v18 + k1*v28 + k2*v38 + k3*v48)^2 + dot(km,v(9,:))^2)*(2*(v17 + k1*v27 + k2*v37 + k3*v47)^2 + 2*(v18 + k1*v28 + k2*v38 + k3*v48)^2 + 2*(v19 + k1*v29 + k2*v39 + k3*v49)^2);
% coe1 = - 4*(v11 + k1*v21 + k2*v31 + k3*v41).^2 - 4*(v12 + k1*v22 + k2*v32 + k3*v42).^2 - 4*(v13 + k1*v23 + k2*v33 + k3*v43).^2 - 4*(v14 + k1*v24 + k2*v34 + k3*v44).^2 - 4*(v15 + k1*v25 + k2*v35 + k3*v45).^2 - 4*(v16 + k1*v26 + k2*v36 + k3*v46).^2 - 4*(v17 + k1*v27 + k2*v37 + k3*v47).^2 - 4*(v18 + k1*v28 + k2*v38 + k3*v48).^2 - 4*(v19 + k1*v29 + k2*v39 + k3*v49).^2;
% syms a1 real
% %fa1 = coe3.*a1^3 + coe1.*a1;
% fa1 = coe3.*a1^2 + coe1;    %删去零解

% flag = 1;
% for i = 1 : n_k1
%     fai = subs(fa1,[k1 k2 k3],solution_k123(:,i)');
%     solution_a1 = vpasolve( fai , a1 , [-inf inf]);  
%     num_a1 = size(solution_a1,1);
%     solution_a1k1k2k3( flag:flag+num_a1-1 , 1 ) = solution_a1;
%     solution_a1k1k2k3( flag:flag+num_a1-1 , 2:4 ) = repmat( solution_k123(:,i)' , num_a1 , 1 );
%     flag = flag + num_a1; 
% end
% 
% solution_a1a2a3a4(:,1) = solution_a1k1k2k3(:,1);
% solution_a1a2a3a4(:,2) = solution_a1k1k2k3(:,1).*solution_a1k1k2k3(:,2);
% solution_a1a2a3a4(:,3) = solution_a1k1k2k3(:,1).*solution_a1k1k2k3(:,3);
% solution_a1a2a3a4(:,4) = solution_a1k1k2k3(:,1).*solution_a1k1k2k3(:,4);
% 
% 
% %compute r result
% solution_r = [v1 v2 v3 v4] * solution_a1a2a3a4';
